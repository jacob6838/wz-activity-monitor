syntax = "proto3";

package datahub.v1;

import "common.proto";
import "field_device.proto";
import "activity_area.proto";
import "delay.proto";
import "road_section.proto";
import "recording.proto";
import "google/protobuf/timestamp.proto";

message VehicleLocationUpdated {
    uint64 id = 1;
    string license_plate = 2;
    VehicleOperationType operation_type = 3;
    PointGeometry location = 4;
    double velocity_kph = 5;
    double heading = 6;
    google.protobuf.Timestamp timestamp = 7;
    
    enum VehicleOperationType {
        VEHICLE_OPERATION_STRIPING = 0;
        VEHICLE_OPERATION_PLOWING = 1;
        VEHICLE_OPERATION_MOWING = 2;
        VEHICLE_OPERATION_COMMUTING = 3;
        VEHICLE_OPERATION_OTHER = 4;
        VEHICLE_OPERATION_UNKNOWN = 5;
    }
}

message FieldDeviceCreateRequest {
    FieldDevice field_device = 1;
    google.protobuf.Timestamp updated_time = 2;
}

message FieldDeviceUpdateRequest {
    uint64 id = 1;
    FieldDevice field_device = 2;
    google.protobuf.Timestamp updated_time = 3;
}

message RoadSectionCreateRequest {
    RoadSection proposed_road_section = 1;
    google.protobuf.Timestamp request_time = 2;
    DataHubUpdateSource source = 3;
}

message RoadSectionUpdateRequest {
    uint64 id = 1;
    ActivityArea proposed_road_section = 2;
    google.protobuf.Timestamp request_time = 3;
    DataHubUpdateSource source = 4;
}

message DelayCreated {
    uint64 id = 1;
    Delay delay = 2;
    google.protobuf.Timestamp created_time = 3;
}

message DelayUpdated {
    uint64 id = 1;
    Delay delay = 2;
    google.protobuf.Timestamp updated_time = 3;
}

message ActivityAreaCreateRequest {
    ActivityArea proposed_activity_area = 1;
    google.protobuf.Timestamp request_time = 2;
    DataHubUpdateSource source = 3;
}

message ActivityAreaUpdateRequest {
    uint64 id = 1;
    ActivityArea proposed_activity_area = 2;
    google.protobuf.Timestamp request_time = 3;
    DataHubUpdateSource source = 4;
}


// Data Types
message ReportSummary {
    uint64 id = 1;
    string name = 2;
    string description = 3;
    google.protobuf.Timestamp report_date = 4;
    string contact_name = 5;
    string contact_phone = 6;
}

message RecordingMarkingSummary {
    uint32 path_index = 1;
    repeated RecordingMarking markings = 2;
}

message RecordingSummary {
    uint64 id = 1;
    string name = 2;
    string description = 3;
    google.protobuf.Timestamp report_date = 4;
    double length_meters = 5;
    double position_accuracy_meters = 6;
    LineStringGeometry path = 7;
}

message FieldDeviceSummaryArray {
    repeated FieldDeviceSummary field_device_summary = 1;
}

message FieldDeviceSummary {
    uint64 id = 1;
    FieldDevice device = 2;
    google.protobuf.Timestamp update_date = 3;
}

message DataHubUpdateSource {
    oneof source {
        ReportSummary report_summary = 1;
        RecordingSummary recording_summary = 2;
        FieldDeviceSummaryArray field_device_summaries = 3;
    }
}